# AI-Prophet 開発指示書 (Master Development Log)
最終更新日: 2026年1月18日
開発者: 山本真大
Version: 3.6 (Includes Technical Pivots)

==================================================
## 🌟 1. プロジェクト概要 (Project Overview)
**サービス名:** 不動産営業自動化SaaS『AI-Prophet（エーアイ・プロフェット）』

### 🚩 ビジョン (Vision)
**「不動産流通の完全自動化と、営業マンの役割の再定義」**
物件精査（ブツ出し）と追客（マッチング・提案）という労働時間の8割を占める事務作業をAIエージェントが代行する。
営業マンはブラウザを開いておくだけで、AIが勝手に優良物件を見つけ、顧客のLINEへ最適な提案を行う。
これにより、人間は「作業」から解放され、「対話・コンサルティング」に100%集中できる世界を実現する。

### 🧩 コア・アーキテクチャ (The 4 Modules)
本システムは以下の4つの自律型モジュールで構成される。

**① The Hand（分散型オートパトロール / Current Phase）**
* **技術:** Chrome Extension (Manifest V3)
* **役割:** 営業マンのブラウザを「情報の触手」に変える。業者間サイト（ITANDI BB等）をバックグラウンドで自律巡回し、サーバーサイドクローラーでは取得できない「生の情報」をリアルタイムに収集・構造化する。

**② The Brain（AI要件解析・マッチング）**
* **技術:** Google Gemini 2.5 Flash
* **役割:** 顧客の曖昧な言語（LINEチャット）を解析して構造化データに変換し、市場物件データとマッチングさせる。さらに、顧客に刺さる提案文や、条件乖離時の逆提案トークを生成する。

**③ The Compliance（死活監視・価格改定検知）**
* **技術:** Automation Logic
* **役割:** DB内の物件情報を定期的に再チェック。掲載終了（おとり物件化）の即時検知や、価格ダウン時の「チャンス提案」のトリガーを引く。

**④ The Assets（マルチテナント型物件DB）**
* **技術:** Firebase Firestore
* **役割:** 各社・各チームごとに分離されたセキュアな資産データベース。収集したデータを組織内で共有し、チームの成約率を最大化する。

==================================================
## 📅 開発ステータス (Current Status)
**現在フェーズ:** Phase 4 (AI脳の実装 & UI刷新) 完了
**次のフェーズ:** Phase 5 (The Hand: 自動巡回機能の実装)

### ✅ 達成されたマイルストーン
1.  **スクレイピングエンジンの確立 (The Hand - Prototype):**
    * ITANDI BBの詳細ページから、賃料・初期費用明細・設備など全データを構造化して取得するロジック（ラベル検索方式）を実装完了。
2.  **生成AIの完全統合 (The Brain - V1):**
    * 最新モデル `gemini-2.5-flash` を搭載。
    * 物件データを元に、LINE送信に適した「親しみやすく、かつ信頼感のある提案文」を自動生成するパイプラインを構築。
3.  **UI/UXの実装:**
    * Chrome拡張機能上でAIの処理状況を可視化し、生成結果をワンクリックでコピーできるダッシュボードを実装。

==================================================
## 🛠 技術スタック (Tech Stack)
* **Frontend (The Hand):** Chrome Extension (Manifest V3), Vanilla JS
* **Backend (The Assets):** Firebase Firestore (NoSQL), Authentication
* **AI Core (The Brain):** Google Gemini API (`gemini-2.5-flash`)
* **Target Sites:** ITANDI BB (順次、REINS/ATBB等へ拡大予定)

==================================================
## 🛤 ロードマップ (Roadmap)

### Phase 5: The Hand - 自動巡回機能の実装 (Next Immediate Task)
手動での詳細ページ閲覧から、完全自動のバックグラウンド収集へ移行する。
1.  **一覧ページ解析:** 検索結果リストから詳細ページのURLリストを抽出する。
2.  **オートパイロット:** タブを自動生成・廃棄し、人間が操作しているように振る舞いながらデータを収集するループ処理の実装。
3.  **重複排除:** 既存DBと照合し、新規・更新物件のみを処理するロジック。

### Phase 6: The Brain & The Assets - LINE連携と顧客DB
収集したデータを「誰に」届けるかを定義する。
1.  **LINE Messaging API連携:** LINE公式アカウントとFirestoreを接続。
2.  **顧客要件解析:** 顧客とのチャットログから「希望エリア」「予算」「譲れない条件」をAIが抽出し、Customer DBへ保存。

### Phase 7: The Matching - 自動提案システムの結合
1.  **マッチングエンジン:** 「新着物件」が「顧客条件」にヒットした瞬間、Geminiが個別の提案メッセージを作成。
2.  **自動送信/下書き作成:** 営業マンの確認を経て（または全自動で）LINEへプッシュ通知。
3.  **逆提案ロジック:** 条件に合う物件がない場合、「エリアを少しずらせばあります」等の逆提案を行う機能。

### Phase 8: The Compliance - 死活監視と商用ローンチ
1.  **定期再巡回:** 保存済みURLへ定期アクセスし、掲載終了を検知してDBから除外（または成約済みフラグ）する。
2.  **価格改定アラート:** 家賃変更を検知し、検討中顧客へ通知する。

==================================================
## ⚠️ 将来的な技術的転換点 (Technical Pivots)
Phase 7（マッチング実装）への移行時に、現在の仕様から以下の変更（アップグレード）が必要となる。

### 1. AI生成タイミングの移行 (Static to Dynamic)
* **現状 (Phase 4):** 物件取得時（スクレイピング直後）に「一般的な紹介文」を生成して保存している。
* **将来 (Phase 7):** 特定の顧客（Customer DB）とマッチングした瞬間に、「その顧客専用の提案文」を生成するフローへ変更する。
    * *理由:* 「Aさんには家賃の安さを、Bさんには設備の良さをアピールする」というOne-to-Oneマーケティングを実現するため。

### 2. プロンプトエンジニアリングの進化 (Description to Negotiation)
* **現状 (Phase 4):** 物件のスペックから推しポイントを抽出する「紹介型」プロンプト。
* **将来 (Phase 7):** 顧客の希望条件と物件スペックを比較し、条件乖離がある場合に妥協点を提示する「交渉型（逆提案）」プロンプトへ刷新する。
    * *実装イメージ:* `Input: {UserReq: 家賃5万, Prop: 家賃6万} -> Output: "予算は少しオーバーしますが、敷金礼金ゼロなので2年間の総額ではお得です"` といった高度なロジックを組み込む。